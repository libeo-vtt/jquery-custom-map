!function(i){var t=function(t,n){this.mapWrapper=i(t),this.mapObj=null,this.map=null,this.config=i.extend({locked:!1,htmlMarkers:!1,hideHtmlMarkers:!0,lat:0,lng:0,zoom:0,styles:[],markers:[],customGlobalClasses:{}},n||{}),this.classes=i.extend({active:"is-active",open:"is-open",hover:"is-hover",clicked:"is-clicked",extern:"is-external",error:"is-error"},(void 0!==window.classes?window.classes:this.config.customGlobalClasses)||{}),this.init()};i.extend(t.prototype,{init:function(){window.googleAPI||this.loadAPI(),i(window).on("googleAPI",i.proxy(this.callback,this))},loadAPI:function(){window.googleAPI=!0,i.getScript("https://www.google.com/jsapi",i.proxy(function(){window.google.maps||google.load("maps","3",{other_params:"sensor=false",callback:i.proxy(function(){i(window).trigger("googleAPI")},this)})},this))},callback:function(){this.createMap()},createMap:function(){this.mapWrapper.append('<div class="map-inner-wrapper"></div>'),this.$mapObj=this.mapWrapper.find(".map-inner-wrapper"),this.mapObj=this.$mapObj.get(0),this.$mapObj.css("height","100%"),this.bounds=new window.google.maps.LatLngBounds,this.map=new window.google.maps.Map(this.mapObj,{mapTypeId:"roadmap",disableDefaultUI:!0,center:new window.google.maps.LatLng(this.config.lat,this.config.lng),zoom:this.config.zoom,styles:this.config.styles}),this.bindMapEvents(),this.addMarkersJs(),1==this.config.htmlMarkers&&this.addMarkersHTML(),1==this.config.locked&&this.lockMap()},addMarkersJs:function(){var t=this.config.markers.length;_.each(this.config.markers,i.proxy(function(i){i.position=new window.google.maps.LatLng(i.lat,i.lng),this.addMarker(i),t>1&&(this.bounds.extend(position),this.map.fitBounds(this.bounds))},this))},addMarkersHTML:function(){var t=this.mapWrapper.find(".markers"),n=(this.mapWrapper.find(".markers > .marker").length,this.mapWrapper.find(".marker"));1==this.config.hideHtmlMarkers&&t.hide(),_.each(n,i.proxy(function(t){var n=[];n.position=new window.google.maps.LatLng(i(t).attr("data-lat"),i(t).attr("data-lng")),n.icon=i(t).attr("data-icon"),n.title=i(t).attr("data-title"),n.infoWindowContent=i(t).html(),this.addMarker(n),length>1&&(this.bounds.extend(position),this.map.fitBounds(this.bounds))},this))},addMarker:function(i){var t="",n=new window.google.maps.Marker({position:i.position,map:this.map,icon:i.icon,title:i.title});""!=i.infoWindowContent&&null!=i.infoWindowContent&&(t=new google.maps.InfoWindow({content:i.infoWindowContent}),this.addInfoWindow(n,t))},addInfoWindow:function(i,t){i.addListener("click",function(){t.open(this.map,i)})},lockMap:function(){this.$mapObj.css("pointer-events","none"),this.bindLockMapEvents()},bindMapEvents:function(){window.google.maps.event.addDomListener(window,"resize",i.proxy(function(){var i=this.map.getCenter();window.google.maps.event.trigger(this.map,"resize"),this.map.setCenter(i)},this))},bindLockMapEvents:function(){this.mapWrapper.on("click",i.proxy(function(){this.mapWrapper.addClass("is-active"),this.$mapObj.css("pointer-events","auto")},this)),this.mapWrapper.on("mouseleave",i.proxy(function(){this.mapWrapper.removeClass("is-active"),this.$mapObj.css("pointer-events","none")},this))}}),i.fn.map=function(n){return this.each(function(){var o=i(this);if(!o.data("map")){var s=new t(this,n);o.data("map",s)}})}}(jQuery);